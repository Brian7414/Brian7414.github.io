<html>

<head>
    <script src="https://unpkg.com/p5"></script>
    <script src="https://unpkg.com/p5.collide2d"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.3.1/addons/p5.sound.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
</head>

<body>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: gray;
        }

        h1 {
            font-family: 'VT323', monospace;

        }
    </style>
    <h1 id="point">score:0</h1>
    <h1 id="life">life:3</h1>
    <h1 id="bosslife"></h1>
    <script>
        var w = 800;
        var h = window.innerHeight;
        var wi = (window.innerWidth / 2) - w / 2;
        var x = w / 2;
        var y = h / 2;
        var fighterone;
        var fighterop;
        var bossone;
        var smallenemy;
        var enemytwo;
        var bullet;
        var bossone;
        var bossop;
        var bossatkpic;
        var bossatk;
        var bossatk2;
        var smallpic;
        var enemytwopic;
        var fireball;
        var explo;
        var fireball2;
        var explopic;
        var force = 25;
        var gravity = 10;
        var gravity2 = 10;
        var speed = 2;
        var score = 0;
        var timer = 0;
        var life = 3;
        var bg;
        var y1 = 0;
        var y2 = h;
        var bosslife = 15;
        hit1 = false;
        hit2 = false;
        hit3 = false;
        hit4 = false;
        hit5 = false;
        hit6 = false;
        var bosshp;
        var boing;
        var button;
        var button2;
        var mod = 0;
        var opening = "Space War"

        function preload() {
            bg = loadImage("bg.jpg");
            fighterop = loadImage("figherone.png");
            bossop = loadImage("bossone.png");
            fireball = loadImage("fireball.png");
            smallpic = loadImage("enemyone.png");
            explopic = loadImage("explosion.png");
            enemytwopic = loadImage("enemytwo.png");
            bossatkpic = loadImage("bossatk.png");
            fireball2 = loadImage("fireball2.png");
        }

        function setup() {
            canvas = createCanvas(w, h);
            canvas.position(wi, 0);
            fighterone = new fighterone();
            bossone = new bossone();
            smallenemy = new smallenemy();
            bullet = new bullet();
            enemytwo = new enemytwo();
            bossatk = new bossatk();
            button = createButton('start');
            button.mousePressed(start);
            button.position(w / 2 - 50, h / 2);
            button.size(200, 150);
            button.style('font-size', "30px");
        }


        function draw() {
            if (mod == 0) {
                image(bg, 0, y1, w, h);
                text(opening, w / 2 - 250, h / 2);
                textSize(100);
                fill(255);
            }
            if (mod == 1) {
                image(bg, 0, y1, w, h);
                image(bg, 0, y2, w, h);
                y1 += speed;
                y2 += speed;
                if (y1 > h) {
                    y1 = -h;
                }
                if (y2 > h) {
                    y2 = -h;
                }
                fighterone.show();
                smallenemy.show();
                smallenemy.move();
                bullet.show();
                bullet.move();
                if (score >= 10) {
                    enemytwo.show();
                    enemytwo.move();
                }
                if (bossone.y >= 50) {
                    bossatk.atk1();
                }
                if (score == 50) {
                    life = 10;
                    document.getElementById('life').innerHTML = "life:" + life;
                }
                if (score >= 60) {
                    bossone.show();
                    bossone.move();
                    smallenemy.stop();
                    enemytwo.stop();
                }
                hit1 = collideRectRect(bullet.x, bullet.y, 50, 50, smallenemy.x, smallenemy.y, 50, 50);
                hit2 = collideRectRect(bullet.x, bullet.y, 50, 50, enemytwo.x, enemytwo.y, 50, 50);
                hit3 = collideRectRect(fighterone.x, fighterone.y, 50, 50, smallenemy.x, smallenemy.y, 50, 50);
                hit4 = collideRectRect(fighterone.x, fighterone.y, 50, 50, enemytwo.x, enemytwo.y, 50, 50);
                hit5 = collideRectCircle(fighterone.x, fighterone.y, 50, 50, bossatk.x + 150, bossatk.y + 100, 300);
                hit6 = collideRectRect(bullet.x, bullet.y, 50, 50, bossone.x + 50, bossone.y - 100, 200, 400);
            }
            if (bosslife <= 0) {
                mod = 2;
            }
            if (mod == 2) {
                image(explopic, bossone.x, bossone.y, 500, 500);
                image(bg, 0, 0, w, h);
                text("stage one clear", w / 2 - 350, h / 2);
                textSize(100);
                fill(255);
                button.style("diaplay", "none");
            }

            if (life == 0) {
                mod = 3;
            }
            if (mod == 3) {
                image(explopic, bossone.x, bossone.y, 500, 500);
                image(bg, 0, 0, w, h);
                text("Game Over", w / 2 - 250, h / 2);
                textSize(100);
                fill(255);
            }
        }

        function start() {
            if (mod == 0) {
                mod = 1;
            }
            if (mod == 3) {
                mod = 1;
            }
        }





        function fighterone() {
            this.w = 100;
            this.h = 100;
            this.x = (w / 2) - this.w / 2;
            this.y = h - this.h;
            ax = this.x;
            ay = this.y;

            this.show = function () {
                image(fighterop, this.x, this.y, this.w, this.h);
                if (keyIsDown(65)) {
                    this.x -= 10;
                }

                if (keyIsDown(68)) {
                    this.x += 10;
                }
                if ((keyIsDown(65)) && (this.x < 0)) {
                    this.x = 0;
                }

                if ((keyIsDown(68)) && (this.x > w - this.w)) {
                    this.x = w - this.w;
                }
            }
        }

        function bullet() {
            this.x = fighterone.x;
            this.y = fighterone.y;
            this.show = function () {
                image(fireball, this.x, this.y, 50, 50);
            }
            this.move = function () {
                if (millis() <= 10 + timer) {
                    this.y -= force;
                    timer = millis();
                }

                if (this.y <= 0 - 50) {
                    this.x = fighterone.x;
                    this.y = fighterone.y;
                }
                if (hit6 == true) {
                    image(explopic, this.x, this.y, 100, 100);
                    bosslife -= 1;
                    document.getElementById('bosslife').innerHTML = "BossHp:" + bosslife;
                    this.x = fighterone.x;
                    this.y = fighterone.y;
                }
            }

        }


        function smallenemy() {
            this.y = -70;
            this.x = random(50, w - 50);
            this.show = function () {
                image(smallpic, this.x, this.y, 50, 50);
            }
            this.move = function () {
                if (millis() >= 10 + timer) {
                    this.y += gravity;
                    timer = millis();
                }
                if (this.y >= h + 50) {
                    this.y = -50;
                    this.x = random(50, w - 50);
                }
                if (hit1 == true) {
                    score += 10;
                    document.getElementById('point').innerHTML = "score:" + score;
                    image(explopic, this.x, this.y, 100, 100);
                    this.y = -50;
                    this.x = random(50, w - 50);
                }
                if ((hit3 == true)) {
                    life -= 1;
                    document.getElementById('life').innerHTML = "life:" + life;
                    image(explopic, this.x, this.y, 100, 100);
                    this.y = -50;
                    this.x = random(50, w - 50);
                }
                this.stop = function () {
                    this.y = -70;
                    this.x = -70;
                }
            }
        }

        function enemytwo() {
            this.y = -70;
            this.x = random(50, w - 50);
            this.show = function () {
                image(enemytwopic, this.x, this.y, 50, 50);
            }
            this.move = function () {
                if (millis() <= 10 + timer) {
                    this.y += gravity2;
                    timer = millis();
                }
                if (this.y >= h + 50) {
                    this.y = -50;
                    this.x = random(50, w - 50);
                }
                if (hit2 == true) {
                    score += 10;
                    document.getElementById('point').innerHTML = "score:" + score;
                    image(explopic, this.x, this.y, 100, 100);
                    this.y = -50;
                    this.x = random(50, w - 50);

                }
                if ((hit4 == true)) {
                    life -= 1;
                    document.getElementById('life').innerHTML = "life:" + life;
                    image(explopic, this.x, this.y, 100, 100);
                    this.y = -50;
                    this.x = random(50, w - 50);
                }
                this.stop = function () {
                    this.y = -70;
                    this.x = -70;
                }
            }
        }

        function bossone() {
            this.x = x - 150;
            this.y = -500;
            this.v = 0;
            this.g = 0.5;
            this.show = function () {
                image(bossop, this.x, this.y, 300, 400);
            }
            this.move = function () {
                this.v += this.g;
                this.y += this.v;
                this.v *= 0.9;
                if (this.y > 50) {
                    this.y = 50;
                    this.v = 1;
                }
                if (bosslife <= 1) {
                    frameRate(10);
                }
                if (bosslife <= 0) {
                    frameRate(60);
                    image(explopic, this.x, this.x, 400, 400);
                    this.x = 800;
                    this.y = -400;
                }
            }
        }

        function bossatk() {
            this.x = (w / 2) - 150;
            this.y = 150;
            this.v = 0;
            this.g = 0.5;
            this.atk1 = function () {
                image(bossatkpic, this.x, this.y, 300, 300);
                this.v += this.g;
                this.y += this.v;
                this.v *= 1;
                if (this.y > h) {
                    this.y = 150;
                    this.v = 1;
                }
                if ((hit5 == true)) {
                    life -= 2;
                    document.getElementById('life').innerHTML = "life:" + life;
                    this.x = (w / 2) - 150;
                    this.y = 150;
                    this.v = 1;
                }
            }
        }
    </script>
</body>

</html>